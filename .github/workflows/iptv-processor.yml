name: IPTV Channel Processor

on:
  # æ¯å¤©UTCæ—¶é—´2:00è‡ªåŠ¨è¿è¡Œ
  schedule:
    - cron: '0 2 * * *'
  # æ”¯æŒæ‰‹åŠ¨è§¦å‘
  workflow_dispatch:
  # å½“å·¥ä½œæµæ–‡ä»¶æ›´æ”¹æ—¶è¿è¡Œ
  push:
    paths:
      - '.github/workflows/iptv-processor.yml'

permissions:
  # è®¾ç½®ä»“åº“è¯»å†™æƒé™
  contents: write

jobs:
  process-iptv:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
        
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install requests
        
    - name: Create Python processing script
      run: |
        cat > process_iptv.py << 'EOF'
        #!/usr/bin/env python3
        import re
        import requests
        import time
        import os
        from datetime import datetime
        
        # ç”¨æˆ·ä»£ç†
        HEADERS = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36'
        }
        
        # æ–‡ä»¶æ˜ å°„å…³ç³»
        FILE_MAPPING = {
            'live1.m3u': 'å¤®è§†é¢‘é“',
            'live2.m3u': 'å«è§†é¢‘é“',
            'live3.m3u': 'å¤®è§†å’ªå’•',
            'live4.m3u': 'å«è§†å’ªå’•',
            'live5.m3u': 'å½±è§†é¢‘é“',
            'live6.m3u': 'è™ç‰™å½±è§†',
            'live7.m3u': 'æ¸¸æˆèµ›äº‹',
            'live8.m3u': 'å’ªè§†ç•Œbc',
            'live9.m3u': 'å†°èŒ¶ä½“è‚²',
            'live10.m3u': 'å‡¤å‡°é¢‘é“'
        }
        
        def download_m3u(url, retries=3):
            """ä¸‹è½½M3Uæ–‡ä»¶"""
            for attempt in range(retries):
                try:
                    print(f"æ­£åœ¨ä¸‹è½½: {url}")
                    response = requests.get(url, headers=HEADERS, timeout=30)
                    response.raise_for_status()
                    
                    content = response.text
                    if '#EXTM3U' in content or '#EXTINF' in content:
                        print(f"ä¸‹è½½æˆåŠŸ: {len(content)} å­—ç¬¦")
                        return content
                    else:
                        print(f"è­¦å‘Š: å¯èƒ½ä¸æ˜¯æœ‰æ•ˆçš„M3Uæ–‡ä»¶")
                        return content
                        
                except Exception as e:
                    print(f"ä¸‹è½½å¤±è´¥ (å°è¯• {attempt+1}/{retries}): {e}")
                    if attempt < retries - 1:
                        time.sleep(2)
            return None
        
        def parse_m3u_channels(content):
            """è§£æM3Ué¢‘é“"""
            channels = []
            
            if not content:
                return channels
                
            lines = content.split('\n')
            current_channel = {}
            
            for line in lines:
                line = line.strip()
                
                if line.startswith('#EXTINF:'):
                    current_channel = {
                        'extinf': line,
                        'name': '',
                        'group': '',
                        'url': ''
                    }
                    
                    # æå–é¢‘é“åç§°
                    name_match = re.search(r',(.*)', line)
                    if name_match:
                        current_channel['name'] = name_match.group(1).strip()
                    
                    # æå–åˆ†ç»„
                    group_match = re.search(r'group-title="([^"]+)"', line)
                    if group_match:
                        current_channel['group'] = group_match.group(1)
                        
                elif line and not line.startswith('#') and current_channel and 'url' not in current_channel:
                    current_channel['url'] = line
                    channels.append(current_channel.copy())
                    current_channel = {}
            
            return channels
        
        def process_source1(channels):
            """å¤„ç†ç¬¬ä¸€ä¸ªæº"""
            print("\n=== å¤„ç†ç¬¬ä¸€ä¸ªæº ===")
            
            # åˆå§‹åŒ–ç»“æœ
            results = {
                'live1': [],  # cctvå’ŒMCP
                'live2': [],  # å«è§†å’ŒMCP
                'live3': [],  # CCTV
                'live4': []   # å«è§†
            }
            
            for channel in channels:
                name = channel.get('name', '')
                
                # live1: åŒ…å«cctvå’ŒMCP
                if 'cctv' in name.lower() and 'MCP' in name:
                    results['live1'].append(channel)
                
                # live2: åŒ…å«å«è§†å’ŒMCP
                elif 'å«è§†' in name and 'MCP' in name:
                    results['live2'].append(channel)
                
                # live3: åŒ…å«CCTV (ä¸åŒ…å«MCP)
                elif 'CCTV' in name and 'MCP' not in name:
                    results['live3'].append(channel)
                
                # live4: åŒ…å«å«è§† (ä¸åŒ…å«MCP)
                elif 'å«è§†' in name and 'MCP' not in name:
                    results['live4'].append(channel)
            
            # è¾“å‡ºç»Ÿè®¡
            print(f"live1.m3u (å¤®è§†é¢‘é“): {len(results['live1'])} ä¸ªé¢‘é“")
            print(f"live2.m3u (å«è§†é¢‘é“): {len(results['live2'])} ä¸ªé¢‘é“")
            print(f"live3.m3u (å¤®è§†å’ªå’•): {len(results['live3'])} ä¸ªé¢‘é“")
            print(f"live4.m3u (å«è§†å’ªå’•): {len(results['live4'])} ä¸ªé¢‘é“")
            
            return results
        
        def process_source2(channels):
            """å¤„ç†ç¬¬äºŒä¸ªæº"""
            print("\n=== å¤„ç†ç¬¬äºŒä¸ªæº ===")
            
            # åˆå§‹åŒ–ç»“æœ
            results = {
                'live5': [],   # å…¶ä»–é¢‘é“ -> å½±è§†é¢‘é“
                'live6': [],   # è™ç‰™å½±è§†
                'live7': [],   # æ¸¸æˆèµ›äº‹
                'live8': [],   # å’ªè§†ç•Œbc
                'live9': [],   # å†°èŒ¶ä½“è‚²
                'live10': []   # å‡¤å‡°é¢‘é“
            }
            
            for channel in channels:
                group = channel.get('group', '')
                name = channel.get('name', '')
                
                # live7: æ¸¸æˆèµ›äº‹
                if 'æ¸¸æˆèµ›äº‹' in group:
                    results['live7'].append(channel)
                
                # live6: è™ç‰™å½±è§†
                elif 'è™ç‰™å½±è§†' in group:
                    results['live6'].append(channel)
                
                # live8: å’ªè§†ç•Œbc
                elif 'å’ªè§†ç•Œbc' in group:
                    results['live8'].append(channel)
                
                # live9: å†°èŒ¶ä½“è‚²
                elif 'å†°èŒ¶ä½“è‚²' in group:
                    results['live9'].append(channel)
                
                # live10: å‡¤å‡°é¢‘é“
                elif 'ç²¤è¯­é¢‘é“' in group:
                    if any(phoenix in name for phoenix in ['å‡¤å‡°ä¸­æ–‡', 'å‡¤å‡°èµ„è®¯', 'å‡¤å‡°é¦™æ¸¯']):
                        results['live10'].append(channel)
                
                # live5: å…¶ä»–é¢‘é“
                elif 'å…¶ä»–é¢‘é“' in group:
                    results['live5'].append(channel)
            
            # è¾“å‡ºç»Ÿè®¡
            print(f"live5.m3u (å½±è§†é¢‘é“): {len(results['live5'])} ä¸ªé¢‘é“")
            print(f"live6.m3u (è™ç‰™å½±è§†): {len(results['live6'])} ä¸ªé¢‘é“")
            print(f"live7.m3u (æ¸¸æˆèµ›äº‹): {len(results['live7'])} ä¸ªé¢‘é“")
            print(f"live8.m3u (å’ªè§†ç•Œbc): {len(results['live8'])} ä¸ªé¢‘é“")
            print(f"live9.m3u (å†°èŒ¶ä½“è‚²): {len(results['live9'])} ä¸ªé¢‘é“")
            print(f"live10.m3u (å‡¤å‡°é¢‘é“): {len(results['live10'])} ä¸ªé¢‘é“")
            
            return results
        
        def save_channel_file(channels, filename, category_name):
            """ä¿å­˜é¢‘é“åˆ°æ–‡ä»¶"""
            if not channels:
                print(f"  {filename}: æ— é¢‘é“ï¼Œåˆ›å»ºç©ºæ–‡ä»¶")
                # åˆ›å»ºç©ºæ–‡ä»¶ä½†åŒ…å«åŸºæœ¬ä¿¡æ¯
                content = f'#EXTM3U\n# {category_name}\n# æ›´æ–°æ—¶é—´: {datetime.now().strftime("%Y-%m-%d %H:%M:%S")}\n# é¢‘é“æ•°é‡: 0\n'
                with open(filename, 'w', encoding='utf-8') as f:
                    f.write(content)
                return
            
            content = f'#EXTM3U x-tvg-url=""\n'
            content += f'# {category_name}\n'
            content += f'# æ›´æ–°æ—¶é—´: {datetime.now().strftime("%Y-%m-%d %H:%M:%S")}\n'
            content += f'# é¢‘é“æ•°é‡: {len(channels)}\n\n'
            
            for channel in channels:
                extinf = channel['extinf']
                # æ›´æ–°åˆ†ç»„åç§°ä¸ºåˆ†ç±»åç§°
                if 'group-title="' in extinf:
                    extinf = re.sub(r'group-title="[^"]+"', f'group-title="{category_name}"', extinf)
                else:
                    extinf = f'#EXTINF:-1 group-title="{category_name}",{channel["name"]}'
                
                content += f'{extinf}\n'
                content += f'{channel["url"]}\n\n'
            
            with open(filename, 'w', encoding='utf-8') as f:
                f.write(content)
            
            print(f"  âœ“ {filename}: ä¿å­˜ {len(channels)} ä¸ªé¢‘é“ ({category_name})")
        
        def create_combined_iptv():
            """åˆ›å»ºæ•´åˆçš„iptv.m3uæ–‡ä»¶"""
            print("\n=== åˆ›å»ºæ•´åˆæ–‡ä»¶ ===")
            
            # æŒ‰æŒ‡å®šé¡ºåºçš„æ–‡ä»¶åˆ—è¡¨
            file_order = [
                'live1.m3u',   # å¤®è§†é¢‘é“
                'live2.m3u',   # å«è§†é¢‘é“
                'live3.m3u',   # å¤®è§†å’ªå’•
                'live4.m3u',   # å«è§†å’ªå’•
                'live5.m3u',   # å½±è§†é¢‘é“
                'live6.m3u',   # è™ç‰™å½±è§†
                'live7.m3u',   # æ¸¸æˆèµ›äº‹
                'live8.m3u',   # å’ªè§†ç•Œbc
                'live9.m3u',   # å†°èŒ¶ä½“è‚²
                'live10.m3u'   # å‡¤å‡°é¢‘é“
            ]
            
            combined_content = '#EXTM3U x-tvg-url=""\n'
            combined_content += f'# æ•´åˆIPTVé¢‘é“åˆ—è¡¨\n'
            combined_content += f'# ç”Ÿæˆæ—¶é—´: {datetime.now().strftime("%Y-%m-%d %H:%M:%S")}\n'
            combined_content += f'# æ¥æº: ottiptv.cc + bc.188766.xyz\n\n'
            
            total_channels = 0
            valid_files = 0
            
            for filename in file_order:
                if os.path.exists(filename):
                    with open(filename, 'r', encoding='utf-8') as f:
                        file_content = f.read()
                    
                    # æå–é¢‘é“å†…å®¹ï¼ˆè·³è¿‡æ³¨é‡Šå’Œç©ºè¡Œï¼‰
                    lines = file_content.split('\n')
                    channel_section = []
                    in_channel_section = False
                    
                    for line in lines:
                        if line.startswith('#EXTINF:'):
                            in_channel_section = True
                        if in_channel_section and line.strip():
                            channel_section.append(line)
                    
                    if channel_section:
                        # æ·»åŠ åˆ†ç±»æ ‡é¢˜
                        category_name = FILE_MAPPING.get(filename, filename.replace('.m3u', ''))
                        combined_content += f'# {category_name}\n'
                        
                        # æ·»åŠ é¢‘é“å†…å®¹
                        for line in channel_section:
                            combined_content += f'{line}\n'
                        
                        combined_content += '\n'
                        
                        # ç»Ÿè®¡
                        channel_count = file_content.count('#EXTINF:')
                        total_channels += channel_count
                        valid_files += 1
                        print(f"  {filename}: {channel_count} ä¸ªé¢‘é“ â†’ æ•´åˆå®Œæˆ")
                else:
                    print(f"  {filename}: æ–‡ä»¶ä¸å­˜åœ¨ï¼Œè·³è¿‡")
            
            # æ·»åŠ ç»Ÿè®¡ä¿¡æ¯
            combined_content += f'# æ€»è®¡: {total_channels} ä¸ªé¢‘é“\n'
            combined_content += f'# åˆ†ç±»: {valid_files} ä¸ª\n'
            combined_content += f'# æ›´æ–°æ—¶é—´: {datetime.now().strftime("%Y-%m-%d %H:%M:%S")}\n'
            
            # ä¿å­˜æ•´åˆæ–‡ä»¶
            with open('iptv.m3u', 'w', encoding='utf-8') as f:
                f.write(combined_content)
            
            print(f"\nâœ“ iptv.m3u åˆ›å»ºæˆåŠŸ")
            print(f"âœ“ æ€»é¢‘é“æ•°: {total_channels}")
            print(f"âœ“ æœ‰æ•ˆåˆ†ç±»: {valid_files} ä¸ª")
            
            return total_channels
        
        def main():
            print("=" * 60)
            print("IPTVé¢‘é“å¤„ç†å¼€å§‹")
            print("=" * 60)
            
            # å¤„ç†ç¬¬ä¸€ä¸ªæº
            url1 = "https://live.ottiptv.cc/iptv.m3u?userid=8137863657&sign=2c8d82c9f17f480726d4770be9d0fb33fd0fcb31e1024448c36663605ea6a3f99e5bd467b68c287e3f0c07f85b95a188139aa3f19e227e251dc707bce0ededaab73ceeaddf6195&auth_token=54741b289e946919fc1c34ca88db58a4"
            content1 = download_m3u(url1)
            
            if content1:
                channels1 = parse_m3u_channels(content1)
                print(f"æº1è§£æåˆ° {len(channels1)} ä¸ªé¢‘é“")
                source1_results = process_source1(channels1)
                
                # ä¿å­˜æº1çš„æ–‡ä»¶
                print("\nä¿å­˜æº1æ–‡ä»¶:")
                save_channel_file(source1_results['live1'], 'live1.m3u', 'å¤®è§†é¢‘é“')
                save_channel_file(source1_results['live2'], 'live2.m3u', 'å«è§†é¢‘é“')
                save_channel_file(source1_results['live3'], 'live3.m3u', 'å¤®è§†å’ªå’•')
                save_channel_file(source1_results['live4'], 'live4.m3u', 'å«è§†å’ªå’•')
            else:
                print("æº1ä¸‹è½½å¤±è´¥ï¼Œåˆ›å»ºç©ºæ–‡ä»¶")
                # åˆ›å»ºç©ºæ–‡ä»¶
                for filename, category in [('live1.m3u', 'å¤®è§†é¢‘é“'), ('live2.m3u', 'å«è§†é¢‘é“'), 
                                          ('live3.m3u', 'å¤®è§†å’ªå’•'), ('live4.m3u', 'å«è§†å’ªå’•')]:
                    save_channel_file([], filename, category)
            
            # å¤„ç†ç¬¬äºŒä¸ªæº
            url2 = "https://bc.188766.xyz/?url=https://live.188766.xyz&mishitong=true&mima=mianfeibuhuaqian&huikan=1"
            content2 = download_m3u(url2)
            
            if content2:
                channels2 = parse_m3u_channels(content2)
                print(f"æº2è§£æåˆ° {len(channels2)} ä¸ªé¢‘é“")
                source2_results = process_source2(channels2)
                
                # ä¿å­˜æº2çš„æ–‡ä»¶
                print("\nä¿å­˜æº2æ–‡ä»¶:")
                save_channel_file(source2_results['live5'], 'live5.m3u', 'å½±è§†é¢‘é“')
                save_channel_file(source2_results['live6'], 'live6.m3u', 'è™ç‰™å½±è§†')
                save_channel_file(source2_results['live7'], 'live7.m3u', 'æ¸¸æˆèµ›äº‹')
                save_channel_file(source2_results['live8'], 'live8.m3u', 'å’ªè§†ç•Œbc')
                save_channel_file(source2_results['live9'], 'live9.m3u', 'å†°èŒ¶ä½“è‚²')
                save_channel_file(source2_results['live10'], 'live10.m3u', 'å‡¤å‡°é¢‘é“')
            else:
                print("æº2ä¸‹è½½å¤±è´¥ï¼Œåˆ›å»ºç©ºæ–‡ä»¶")
                # åˆ›å»ºç©ºæ–‡ä»¶
                for filename, category in [('live5.m3u', 'å½±è§†é¢‘é“'), ('live6.m3u', 'è™ç‰™å½±è§†'),
                                          ('live7.m3u', 'æ¸¸æˆèµ›äº‹'), ('live8.m3u', 'å’ªè§†ç•Œbc'),
                                          ('live9.m3u', 'å†°èŒ¶ä½“è‚²'), ('live10.m3u', 'å‡¤å‡°é¢‘é“')]:
                    save_channel_file([], filename, category)
            
            # åˆ›å»ºæ•´åˆæ–‡ä»¶
            total_channels = create_combined_iptv()
            
            print("\n" + "=" * 60)
            print("å¤„ç†å®Œæˆï¼")
            print(f"æ€»ç”Ÿæˆæ–‡ä»¶: 11ä¸ª (10ä¸ªåˆ†ç±» + 1ä¸ªæ•´åˆ)")
            print(f"æ€»é¢‘é“æ•°: {total_channels}")
            print("=" * 60)
            
            return True
        
        if __name__ == "__main__":
            success = main()
            exit(0 if success else 1)
        EOF
        
    - name: Run processing script
      run: python process_iptv.py
      
    - name: Create index.html for web view
      run: |
        # è·å–å½“å‰æ—¶é—´
        CURRENT_TIME=$(date +"%Y-%m-%d %H:%M:%S UTC")
        
        # ç»Ÿè®¡é¢‘é“æ•°é‡
        TOTAL=0
        if [ -f "iptv.m3u" ]; then
          TOTAL=$(grep -c "^#EXTINF:" iptv.m3u || echo "0")
        fi
        
        # åˆ›å»ºHTMLæ–‡ä»¶
        cat > index.html << EOF
        <!DOCTYPE html>
        <html lang="zh-CN">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>IPTVé¢‘é“åˆ—è¡¨</title>
            <style>
                body {
                    font-family: Arial, sans-serif;
                    max-width: 1000px;
                    margin: 0 auto;
                    padding: 20px;
                    background-color: #f5f5f5;
                }
                h1 {
                    color: #333;
                    border-bottom: 2px solid #4CAF50;
                    padding-bottom: 10px;
                }
                .stats {
                    background-color: white;
                    padding: 15px;
                    border-radius: 5px;
                    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
                    margin-bottom: 20px;
                }
                .file-list {
                    display: grid;
                    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                    gap: 15px;
                }
                .file-card {
                    background-color: white;
                    padding: 15px;
                    border-radius: 5px;
                    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
                }
                .file-card h3 {
                    margin-top: 0;
                    color: #4CAF50;
                }
                .file-link {
                    display: inline-block;
                    background-color: #4CAF50;
                    color: white;
                    padding: 8px 15px;
                    text-decoration: none;
                    border-radius: 4px;
                    margin-top: 10px;
                }
                .file-link:hover {
                    background-color: #45a049;
                }
                .update-time {
                    color: #666;
                    font-style: italic;
                    margin-top: 20px;
                }
            </style>
        </head>
        <body>
            <h1>ğŸ“º IPTVé¢‘é“åˆ—è¡¨</h1>
            
            <div class="stats">
                <h3>ç»Ÿè®¡ä¿¡æ¯</h3>
                <p><strong>æœ€åæ›´æ–°æ—¶é—´ï¼š</strong> $CURRENT_TIME</p>
                <p><strong>æ€»é¢‘é“æ•°é‡ï¼š</strong> $TOTAL ä¸ª</p>
                <p><strong>æ›´æ–°é¢‘ç‡ï¼š</strong> æ¯å¤©è‡ªåŠ¨æ›´æ–°</p>
            </div>
            
            <h2>ä¸»æ’­æ”¾åˆ—è¡¨</h2>
            <div class="file-card">
                <h3>iptv.m3u - å®Œæ•´é¢‘é“åˆ—è¡¨</h3>
                <p>åŒ…å«æ‰€æœ‰åˆ†ç±»çš„å®Œæ•´æ’­æ”¾åˆ—è¡¨</p>
                <a href="iptv.m3u" class="file-link">ä¸‹è½½å®Œæ•´åˆ—è¡¨</a>
                <p><small>åœ¨çº¿æ’­æ”¾é“¾æ¥ï¼š<code>https://raw.githubusercontent.com/${{ github.repository }}/main/iptv.m3u</code></small></p>
            </div>
            
            <h2>åˆ†ç±»æ’­æ”¾åˆ—è¡¨</h2>
            <div class="file-list">
        EOF
        
        # æ·»åŠ å„ä¸ªæ–‡ä»¶ä¿¡æ¯
        FILES=("live1.m3u" "live2.m3u" "live3.m3u" "live4.m3u" "live5.m3u" "live6.m3u" "live7.m3u" "live8.m3u" "live9.m3u" "live10.m3u")
        NAMES=("å¤®è§†é¢‘é“" "å«è§†é¢‘é“" "å¤®è§†å’ªå’•" "å«è§†å’ªå’•" "å½±è§†é¢‘é“" "è™ç‰™å½±è§†" "æ¸¸æˆèµ›äº‹" "å’ªè§†ç•Œbc" "å†°èŒ¶ä½“è‚²" "å‡¤å‡°é¢‘é“")
        
        for i in "${!FILES[@]}"; do
            FILE=${FILES[$i]}
            NAME=${NAMES[$i]}
            
            if [ -f "$FILE" ]; then
                COUNT=$(grep -c "^#EXTINF:" "$FILE" 2>/dev/null || echo "0")
                echo "        <div class=\"file-card\">" >> index.html
                echo "            <h3>$NAME</h3>" >> index.html
                echo "            <p><strong>æ–‡ä»¶åï¼š</strong> $FILE</p>" >> index.html
                echo "            <p><strong>é¢‘é“æ•°é‡ï¼š</strong> $COUNT ä¸ª</p>" >> index.html
                echo "            <a href=\"$FILE\" class=\"file-link\">ä¸‹è½½ $NAME</a>" >> index.html
                echo "        </div>" >> index.html
            fi
        done
        
        cat >> index.html << EOF
            </div>
            
            <div class="update-time">
                æœ€åæ›´æ–°äº: $CURRENT_TIME
            </div>
        </body>
        </html>
        EOF
        
    - name: Commit and push changes
      run: |
        # é…ç½®Git
        git config --local user.email "github-actions[bot]@users.noreply.github.com"
        git config --local user.name "github-actions[bot]"
        
        # æ·»åŠ æ‰€æœ‰ç”Ÿæˆçš„æ–‡ä»¶
        git add process_iptv.py
        git add live*.m3u
        git add iptv.m3u
        git add index.html
        
        # åˆ›å»ºREADME
        echo "# IPTVé¢‘é“åˆ—è¡¨" > README.md
        echo "" >> README.md
        echo "è‡ªåŠ¨ç”Ÿæˆçš„IPTVé¢‘é“åˆ—è¡¨ï¼Œæ¯å¤©æ›´æ–°ã€‚" >> README.md
        echo "" >> README.md
        echo "## ä¸»æ–‡ä»¶" >> README.md
        echo "- [iptv.m3u](iptv.m3u) - å®Œæ•´é¢‘é“åˆ—è¡¨" >> README.md
        echo "" >> README.md
        echo "## åˆ†ç±»æ–‡ä»¶" >> README.md
        echo "- [live1.m3u](live1.m3u) - å¤®è§†é¢‘é“" >> README.md
        echo "- [live2.m3u](live2.m3u) - å«è§†é¢‘é“" >> README.md
        echo "- [live3.m3u](live3.m3u) - å¤®è§†å’ªå’•" >> README.md
        echo "- [live4.m3u](live4.m3u) - å«è§†å’ªå’•" >> README.md
        echo "- [live5.m3u](live5.m3u) - å½±è§†é¢‘é“" >> README.md
        echo "- [live6.m3u](live6.m3u) - è™ç‰™å½±è§†" >> README.md
        echo "- [live7.m3u](live7.m3u) - æ¸¸æˆèµ›äº‹" >> README.md
        echo "- [live8.m3u](live8.m3u) - å’ªè§†ç•Œbc" >> README.md
        echo "- [live9.m3u](live9.m3u) - å†°èŒ¶ä½“è‚²" >> README.md
        echo "- [live10.m3u](live10.m3u) - å‡¤å‡°é¢‘é“" >> README.md
        echo "" >> README.md
        echo "## åœ¨çº¿æŸ¥çœ‹" >> README.md
        echo "è®¿é—® [index.html](index.html) æŸ¥çœ‹ç½‘é¡µç‰ˆæœ¬" >> README.md
        git add README.md
        
        # æäº¤æ›´æ”¹
        if git diff --cached --quiet; then
          echo "æ²¡æœ‰æ›´æ”¹éœ€è¦æäº¤"
        else
          git commit -m "ğŸ“º æ›´æ–°IPTVé¢‘é“åˆ—è¡¨ - $(date +'%Y-%m-%d %H:%M:%S')"
          git push
          echo "æ›´æ”¹å·²æäº¤å¹¶æ¨é€"
        fi
